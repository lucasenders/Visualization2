{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/lucasenders/Visualization2/refs/heads/main/data/country_emissions.csv"
  },
  "width": "container",
  "height": "container",
  "background": "rgb(240, 240, 240)",
  "params": [
    {
      "name": "emission_selection",
      "bind": {
        "input": "select",
        "options": ["co2", "co2_per_capita"],
        "labels": ["Total CO2", "CO2 Per Capita"],
        "name": "Emission Selection: "
      },
      "value": "co2"
    }
  ],
  "transform": [
    {
      "calculate": "datum[emission_selection]",
      "as": "selected_emission"
    }
  ],
  "layer": [
    {
      "mark": "bar",
      "encoding": {
        "x": {
          "field": "selected_emission",
          "type": "quantitative",
          "axis": {
            "labelAngle": 0,
            "title": {
              "signal": "emission_selection === 'co2' ? 'CO2 Emissions in 2022 (Mt)' : 'CO2 Emissions in 2022 (t per person)'"
            }
          }
        },
        "y": {
          "field": "country",
          "type": "nominal",
          "sort": "-x",
          "title": ""
        },
        "color": {
          "condition": {
            "test": "datum.country === 'Australia'",
            "value": "skyblue"
          },
          "value": "lightgrey"
        },
        "tooltip": [
          {"field": "country", "title": "Country"},
          {
            "field": "selected_emission",
            "format": ".3f",
            "title": "CO2 Emissions"
          }
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "center",
        "baseline": "middle",
        "fontStyle": "italic",
        "size": 12
      },
      "encoding": {
        "text": {
          "value": ["Use the filter below", "to switch between", "total emissions and", "emissions per capita"]
        },
        "x": {
          "value": 245
        },
        "y": {
          "value": 94
        }
      }
    }
  ]
}
